#include <stdio.h>
#include <stdlib.h>
#include <unistd.h>
#include <netinet/in.h>
#include <linux/types.h>
#include <linux/netfilter.h> /* for NF_ACCEPT */

#include <libnetfilter_queue/libnetfilter_queue.h>
// #include <libnet.h>

#include "hping2.h"

#define make_str(pointer, str, len) { \
	pointer = (char*) malloc(len+1);\
	strncpy(pointer, str, len);\
	pointer[len] = '\0';\
}

int main() {
	sockraw = open_sockraw();

	struct tcphdr_bsd tcp;
	int i;
	uint32_t seq, ack, port;
	tcp.th_flags = TH_ACK; // | TH_RST;// | TH_URG;
	tcp.th_seq = tcp.th_ack = 0;
	tcp.th_win = 65535;
	scanf("%u %u %u", &port, &seq, &ack);

	tcp.th_seq = seq;
	tcp.th_ack = ack;

	for (i = 0; i < 3; i++) {
		send_tcp(80, port,
			0, 64, (unsigned char*)"h", 1,
			&tcp, "121.40.44.206", "192.168.199.240",
			NULL);
	}

	return 0;
}